name: Quick File Bot Test
on:
  workflow_dispatch:

jobs:
  test-bot:
    runs-on: ubuntu-latest
    timeout-minutes: 5  # فقط 5 دقیقه اجرا شود
    steps:
    - name: Test Telegram connection
      run: |
        echo "🔗 تست اتصال به Telegram..."
        curl -s "https://api.telegram.org/bot7897337548:AAGudjNDkUM5pUWx93mdc6kFBrSqusuj_NA/getMe" | python3 -m json.tool
        
        echo "✅ توکن ربات معتبر است"
        echo "🤖 نام ربات: $(curl -s https://api.telegram.org/bot7897337548:AAGudjNDkUM5pUWx93mdc6kFBrSqusuj_NA/getMe | grep -o '"username":"[^"]*' | cut -d'"' -f4)"

    - name: Send test message
      run: |
        echo "📤 ارسال پیام تست..."
        curl -s -X POST \
          "https://api.telegram.org/bot7897337548:AAGudjNDkUM5pUWx93mdc6kFBrSqusuj_NA/sendMessage" \
          -d "chat_id=123456789" \
          -d "text=🤖 ربات آماده است! (تست از GitHub Actions)" \
          || echo "⚠️ ارسال پیام ناموفق بود"

    - name: Show bot info
      run: |
        echo "=========================================="
        echo "🤖 TELEGRAM BOT INFORMATION"
        echo "=========================================="
        echo "Token: 7897337548:AAGudjNDkUM5pUWx93mdc6kFBrSqusuj_NA"
        echo "Bot URL: https://t.me/$(curl -s https://api.telegram.org/bot7897337548:AAGudjNDkUM5pUWx93mdc6kFBrSqusuj_NA/getMe | grep -o '"username":"[^"]*' | cut -d'"' -f4)"
        echo ""
        echo "💡 برای استفاده:"
        echo "1. با ربات در Telegram چت کنید"
        echo "2. فایل ارسال کنید"
        echo "3. ربات پاسخ خواهد داد"
        echo "=========================================="
